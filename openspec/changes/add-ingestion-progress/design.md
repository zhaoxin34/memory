## Context

当前批量导入文档时，CLI 会在开始时显示总文件数，但处理过程中没有任何进度更新。用户只能看到最终结果，无法了解：
- 当前正在处理哪个文件
- 还剩多少文件
- 预计还需要多长时间

Rich 库已集成在项目中，可用于显示美观的进度条。

## Goals / Non-Goals

**Goals:**
- 在批量导入（多于1个文件）时显示进度条
- 显示：总文档数、已完成数、当前处理的文件名
- 保持单文件导入的简洁输出
- 不影响性能，处理速度与之前相当

**Non-Goals:**
- 不添加 ETA 精确时间估算（处理速度因文件而异）
- 不修改 IngestionPipeline 内部逻辑
- 不添加详细的每步骤计时

## Decisions

### D1: 使用 Rich Progress 而非手动打印

| 方案 | 优点 | 缺点 |
|-----|------|------|
| Rich Progress | 美观、自动刷新、线程安全 | 需要学习 API |
| tqdm | 简洁、广泛使用 | 需要额外依赖 |
| 手动打印 | 无额外依赖 | 需要自己处理换行和刷新 |

**决定**: 使用 Rich Progress。Rich 已集成，无需新依赖，且与项目风格一致。

### D2: 进度显示策略

- 单文件（≤1）: 保持现有简洁输出
- 多文件（>1）: 显示进度条 + 百分比 + 当前文件名

### D3: 异步处理

进度更新需要在异步上下文中进行，使用 `Progress.console.print` 确保线程安全。

## Risks / Trade-offs

| 风险 | 影响 | 缓解措施 |
|-----|------|---------|
| 进度条闪烁 | 用户体验差 | 使用 Rich 的自动刷新机制 |
| 性能开销 | 处理变慢 | 进度更新频率限制在合理范围 |
| 异常处理 | 进度条可能残留 | 使用 try/finally 确保进度条关闭 |

## Open Questions

- [x] 已决定：单文件不显示进度条
- [x] 已决定：使用 Rich Progress

## Migration Plan

1. 修改 `_ingest_async` 函数
2. 添加 Progress 实例
3. 使用 `with Progress(...)` 包装循环
4. 测试单文件和多文件场景
5. 无需数据迁移
